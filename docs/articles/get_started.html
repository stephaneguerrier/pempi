<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>`cape` Vignette • cape</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="`cape` Vignette">
<meta property="og:description" content="cape">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">cape</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../articles/reproducibility.html">Reproducibility</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stephaneguerrier/cape" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>
<code>cape</code> Vignette</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stephaneguerrier/cape/blob/HEAD/vignettes/get_started.Rmd" class="external-link"><code>vignettes/get_started.Rmd</code></a></small>
      <div class="hidden name"><code>get_started.Rmd</code></div>

    </div>

    
    
<div class="section level1">
<h1 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h1>
<p>In epidemiological studies, an important quantity that needs to be estimated with great accuracy is the prevalence rate of a disease in order to learn more about central parameters such as case fatality rate and/or to plan and refine decisions about measures with regards to an epidemic or a pandemic. Traditionally, to measure the prevalence, a survey sample (of randomly chosen subjects from the population) is collected and the prevalence is estimated by the sample proportion. This process involves some financial and logistic efforts, which increase with the number of sampled participants, while at the same time, increasing the accuracy of the estimator. Having a sufficiently large sample is especially important when the (true) prevalence is very small, for example at the beginning of a new pandemic such as the one of the COVID-19. In this case, since the beginning of the outbreak, many measurements have been taken on the number of infected people, but only on the sub-population selected under some medical (and logistic) criteria. It is obvious that using these measurements as if they would be like a complete census, would lead to an underestimation of the prevalence.</p>
<p>In <span class="citation">Guerrier, Kuzmics, and Victoria-Feser (2022)</span>, we propose to adequately use this information, together with data from a survey sample, in order to improve the accuracy of the prevalence estimation. In other terms, for a given (legal) statistical precision that might be required by authorities that finance a survey, the sample size can be a lot smaller if one adequately uses the information provided by the data collected in the sub-population. The possible misclassification errors of the (medical) testing devices used to collect the data, are also taken into account. The misclassification errors are actually induced by the sensitivity, i.e. the complement to the false positive rate, and by the specificity, i.e. the complement to the false negative rate, of the medical testing devices. The approach is a frequentist one, i.e. using cutoff values for the sensitivity and specificity, hence without the need to specify a (prior) distribution for these quantities.</p>
</div>
<div class="section level1">
<h1 id="model">Model<a class="anchor" aria-label="anchor" href="#model"></a>
</h1>
<div class="section level2">
<h2 id="mathematical-setup">Mathematical setup<a class="anchor" aria-label="anchor" href="#mathematical-setup"></a>
</h2>
<p>Consider taking a (random) survey sample of <span class="math inline">\(n\)</span> participants in some population in order to estimate the prevalence <span class="math inline">\(\pi\)</span> of, for example, a given infectious disease. The framework also supposes that prior to the collection of the survey sample, measurement have been taken on a sub-population, not necessarily randomly chosen. Conditionally on this information, one can get the prevalence computed as the number of positive cases (in the sub-population) relative to the (whole) population size, i.e. a prevalence parameter <span class="math inline">\(\pi_0\)</span> which is such that <span class="math inline">\(\pi_0 \leq \pi\)</span>. While <span class="math inline">\(\pi_0\)</span> is known, it cannot be directly used as a proxy for <span class="math inline">\(\pi\)</span>, but the information provided by <span class="math inline">\(\pi_0\)</span>, can be used to improve the accuracy of the estimation of <span class="math inline">\(\pi\)</span>.</p>
<p>More precisely, for each participant in the survey sample, the following information should be available:</p>
<p><span class="math display">\[\begin{equation}
    \begin{aligned}
         X_i&amp; :=
         \left\{
    \begin{array}{ll}
        1  &amp; \quad \mbox{if participant $i$ is positive,} \\
        0  &amp; \quad \mbox{otherwise;}
    \end{array}
\right.\\
         V_i&amp; := \left\{
    \begin{array}{ll}
        1  &amp; \quad \mbox{if participant $i$ is positive and belongs to the sub-population,} \\
        0  &amp; \quad \mbox{otherwise.}
    \end{array}
\right.
    \end{aligned}
    \label{eqn:bernoulli-rv}
\end{equation}\]</span></p>
<p>Note that <span class="math inline">\(\Pr(X_i=1\vert V_i=1) = 1\)</span> and <span class="math inline">\(\Pr(X_i=0\vert V_i=1) = 0\)</span>. The objective is to provide an estimator for the unknown prevalence</p>
<p><span class="math display">\[\begin{equation}
        \pi := \Pr\left(X_i=1\right). 
        \label{eqn:true-pi}
\end{equation}\]</span></p>
<p>However, if we allow for possible misclassification error, the variables in  are latent, and what is observed are the following variables</p>
<p><span class="math display">\[\begin{equation}
    \begin{aligned}
         Y_i&amp; :=
         \left\{
    \begin{array}{ll}
        1  &amp; \quad \mbox{if participant $i$ is tested positive in the survey sample,} \\
        0  &amp; \quad \mbox{otherwise;}
    \end{array}
\right.\\
         W_i&amp; := \left\{
    \begin{array}{ll}
        1  &amp; \quad \mbox{if participant $i$ is tested positive and belongs to the sub-population,} \\
        0  &amp; \quad \mbox{otherwise.}
    \end{array}
\right. 
    \end{aligned}
    \label{eqn:bernoulli-rv-obs}
\end{equation}\]</span></p>
<p>While <span class="math inline">\(Y_i\)</span> is the minimal information collected in the survey sample, <span class="math inline">\(W_i\)</span> is an additional information that could be obtained by asking the participants to provide it. It can be obtained while collecting the information on <span class="math inline">\(Y_i\)</span>, or a posteriori using a followup procedure. In that case, it is not necessary to proceed to the followup for all sampled participants, but only for those with <span class="math inline">\(Y_i=1\)</span>.</p>
<p>We also suppose that the (medical) testing devices have known sensitivity and specificity, or equivalently, False Positive (FP) rates <span class="math inline">\(\alpha = 1-\mbox{specificity}\)</span> and False Negative (FN) rates <span class="math inline">\(\beta = 1-\mbox{sensitivity}\)</span>, that might be different for the two populations. Therefore, we define the following quantities:</p>
<p><span class="math display">\[\begin{equation}
    \begin{aligned}
          \pi_0 &amp; := \Pr(W_i=1) &amp;&amp; \\
    \alpha_0&amp; := \Pr(W_i=1\vert V_i=0) &amp; \quad \quad \alpha&amp; := \Pr(Y_i=1\vert X_i=0) \\
    \beta_0&amp; := \Pr(W_i=0\vert V_i=1) &amp; \quad \quad \beta&amp; := \Pr(Y_i=0\vert X_i=1).
    \end{aligned}
    \label{eqn:missclasserrors}
\end{equation}\]</span></p>
<p>For proper modelling, we assume that <span class="math inline">\(\alpha+\beta&lt;1\)</span> and <span class="math inline">\(\alpha_0+\beta_0&lt;1\)</span> <span class="citation">(see Guerrier, Kuzmics, and Victoria-Feser 2022)</span>. From the above definitions, we can deduce</p>
<p><span class="math display">\[\begin{equation*}
    \pi^*_0=\Pr(V_i=1)=\frac{1}{\Delta_0}(\pi_0-\alpha_0) 
\end{equation*}\]</span></p>
<p>with <span class="math inline">\(\Delta_0=1-(\alpha_0+\beta_0)\)</span>. In the figure below, we present the probability tree associated to the variables involved in this study:</p>
<p>From these variables we deduce the following random variables that are necessary for estimation and inference:</p>
<p><span class="math display">\[\begin{eqnarray}
R_1:=\sum_{i=1}^nY_iW_i \;\;\; \mbox{and} \;\;\;
R_3:= \sum_{i=1}^nY_i(1-W_i) 
\label{eqn:R-R4} 
\end{eqnarray}\]</span></p>
<p>with:</p>
<ul>
<li>
<span class="math inline">\(R_1\)</span>: the number of participants in the survey sample that were tested positive with both (medical) testing devices (and are, thus, members of the sub-population);</li>
<li>
<span class="math inline">\(R_3\)</span> is the number of participants in the survey sample that are tested positive only with the second testing device.</li>
</ul>
<p>If easily available, on can add the following information, that might increase estimation and inference accuracy for survey sample sizes smaller than <span class="math inline">\(n=1,500\)</span>:</p>
<p><span class="math display">\[\begin{equation*}
    R_2:=\sum_{i=1}^n(1-Y_i)W_i
\end{equation*}\]</span></p>
<p>so that <span class="math inline">\(R_0:= \sum_{i=1}^nW_i=R_1+R_2\)</span>, with</p>
<ul>
<li>
<span class="math inline">\(R_0\)</span>: the number of participants in the survey sample that were tested positive in the sub-population;</li>
<li>
<span class="math inline">\(R_2\)</span>: the number of participants in the survey sample that are tested positive only with the first testing device (and are, thus, members of the sub-population).</li>
</ul>
<p>The respective distributions of <span class="math inline">\(R_1,R_2,R_3\)</span> are binomial distributions with success probabilities given below in the next section.</p>
</div>
<div class="section level2">
<h2 id="simulating-data">Simulating data<a class="anchor" aria-label="anchor" href="#simulating-data"></a>
</h2>
<p>Data can be simulated using the function <code><a href="../reference/sim_Rs.html">sim_Rs()</a></code> as follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load cape package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephaneguerrier/cape" class="external-link">cape</a></span><span class="op">)</span>

<span class="co"># Measurement error</span>
<span class="va">alpha</span> <span class="op">=</span> <span class="va">alpha0</span> <span class="op">=</span> <span class="fl">0.01</span>
<span class="va">beta</span> <span class="op">=</span> <span class="va">beta0</span> <span class="op">=</span> <span class="fl">0.02</span>

<span class="co"># Simulation "seed"</span>
<span class="va">seed</span> <span class="op">=</span> <span class="fl">18</span>

<span class="co"># True prevalence</span>
<span class="va">theta</span> <span class="op">=</span> <span class="fl">4</span><span class="op">/</span><span class="fl">100</span>

<span class="co"># Prevalence in sub-population</span>
<span class="va">pi0</span> <span class="op">=</span> <span class="fl">2</span><span class="op">/</span><span class="fl">100</span>

<span class="co"># Sample size</span>
<span class="va">n</span> <span class="op">=</span> <span class="fl">1500</span>

<span class="co"># Simulation data</span>
<span class="va">R</span> <span class="op">=</span> <span class="fu"><a href="../reference/sim_Rs.html">sim_Rs</a></span><span class="op">(</span>theta <span class="op">=</span> <span class="va">theta</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>, n <span class="op">=</span> <span class="va">n</span>, alpha0 <span class="op">=</span> <span class="va">alpha0</span>,
           alpha <span class="op">=</span> <span class="va">alpha</span>, beta0 <span class="op">=</span> <span class="va">beta0</span>, beta <span class="op">=</span> <span class="va">beta</span>, seed <span class="op">=</span> <span class="va">seed</span><span class="op">)</span>

<span class="co"># Print results</span>
<span class="va">R</span></code></pre></div>
<pre><code><span class="co">## Data: R = 71, R0 = 36, n = 1500</span>
<span class="co">##       R1 = 19, R2 = 17, R3 = 52, R4 = 1412</span>
<span class="co">## </span>
<span class="co">## Assumed measurement error: alpha = 1%, alpha0 = 1%, beta  = 2% </span>
<span class="co">## </span>
<span class="co">## False negative rate of the official procedure: beta0 = 74%</span></code></pre>
</div>
</div>
<div class="section level1">
<h1 id="estimators">Estimators<a class="anchor" aria-label="anchor" href="#estimators"></a>
</h1>
<p>The success probabilities associated to <span class="math inline">\(R_j,j=1,2,3\)</span> are functions of the (true) prevalence <span class="math inline">\(\pi\)</span>, and are given by</p>
<p><span class="math display">\[\begin{eqnarray}
    \begin{aligned}
    \tau_1(\pi) &amp;:=  \Pr(W_i=1, Y_i=1) =\pi\Delta\alpha_0+\pi_0^*\Delta_0(1-\beta)+\alpha\alpha_0   \\
    \tau_2(\pi) &amp;:=  \Pr(W_i=1,Y_i=0) = -\pi\Delta\alpha_0+\pi_0^*\Delta_0\beta+(1-\alpha)\alpha_0  \\
    \tau_3(\pi) &amp;:=  \Pr(W_i=0,Y_i=1) = \pi\Delta(1-\alpha_0)-\pi_0^*\Delta_0(1-\beta)+\alpha(1-\alpha_0)  \\
    \tau_4(\pi) &amp;:=  \Pr(W_i=0,Y_i=0) = -\pi\Delta(1-\alpha_0)-\pi_0^*\Delta_0\beta+(1-\alpha)(1-\alpha_0),
    \end{aligned}
    \label{eqn:tau-pi}
\end{eqnarray}\]</span></p>
<p>where <span class="math inline">\(\Delta :=1-(\alpha+\beta)\)</span>. A likelihood function can be built based on the multinomial distribution (with categories <span class="math inline">\(R_1,R_2,R_3,R_4\)</span>, with <span class="math inline">\(R_4=1-R_1-R_2-R_3\)</span>) to obtain the conditional Maximum Likelihood Estimator (MLE) for <span class="math inline">\(\pi\)</span> <span class="citation">(see Guerrier, Kuzmics, and Victoria-Feser 2022)</span>. The MLE has a closed form expressions if <span class="math inline">\(\alpha_0=0\)</span>. If the information provided by <span class="math inline">\(R_2\)</span> is not available, the likelihood function is marginalized out on <span class="math inline">\(R_2\)</span> and one can still obtain an MLE for <span class="math inline">\(\pi\)</span>. Alternatively, the package also contains a Method of Moments Estimator (MME) based on <span class="math inline">\(R_3\)</span> (with expectation <span class="math inline">\(\tau_3(\pi)\)</span>), which is closed form for any <span class="math inline">\(\alpha_0,\alpha,\beta_0,\beta\)</span>.</p>
<p>The confidence intervals for the conditional MLE and the marginal MLE can be computed using asymptotic theory. They provide good coverage, with small interval length for survey sample sizes from <span class="math inline">\(n=1,000\)</span> <span class="citation">(see Guerrier, Kuzmics, and Victoria-Feser 2022)</span>. For the MME, since its finite sample distribution is known through <span class="math inline">\(R_3\sim\mathcal{B}(n,\tau_3(\pi))\)</span>, exact confidence bounds can be computed using, for example, the (fiducial) Clopper–Pearson (CP) approach method, see <span class="citation">Clopper and Pearson (1934)</span>, <span class="citation">Fisher (1935)</span> and <span class="citation">Brown, Cai, and DasGupta (2001)</span>. In the package are implemented, the CP method based on <span class="math inline">\(R_3\)</span>, and the asymptotic theory method for the conditional and marginal MLE (i.e. <span class="math inline">\(R_2\)</span> known or not). An extensive simulation study is provided in <span class="citation">Guerrier, Kuzmics, and Victoria-Feser (2022)</span> that compares coverage probabilities with the different approaches.</p>
<p>To obtain these estimators, one can use the functions <code><a href="../reference/conditional_mle.html">conditional_mle()</a></code>, <code><a href="../reference/marginal_mle.html">marginal_mle()</a></code> and <code><a href="../reference/moment_estimator.html">moment_estimator()</a></code>. Indeed, the conditional MLE can be estimated as follows on the previously simulated data:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_cmle</span> <span class="op">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R1</span>, R2 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R2</span>, R3 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R3</span>, R4 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R4</span>, n <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">pi0</span>,
                           alpha0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha0</span>, alpha <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha</span>, 
                           beta0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta0</span>, beta <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span>
<span class="va">fit_cmle</span></code></pre></div>
<pre><code><span class="co">## Method: Conditional MLE</span>
<span class="co">## </span>
<span class="co">## Estimated proportion: 3.6168%</span>
<span class="co">## Standard error      : 0.4926%</span>
<span class="co">## </span>
<span class="co">## Confidence interval at the 95% level:</span>
<span class="co">## Asymptotic Approach: 2.6512% - 4.5823%</span>
<span class="co">## </span>
<span class="co">## Assumed measurement error: alpha  = 1%, beta = 2%,</span>
<span class="co">##                            alpha0 = 1% </span>
<span class="co">## </span>
<span class="co">## Estimated false negative rate of the</span>
<span class="co">## official procedure: beta0 = 71.35%</span>
<span class="co">## CI at the 95% level: 63.97% - 78.73%</span>
<span class="co">## Sampling: Random</span></code></pre>
<p>Note that the conditional MLE is based on <span class="math inline">\(R_1\)</span>, <span class="math inline">\(R_2\)</span>, <span class="math inline">\(R_3\)</span> and <span class="math inline">\(R_4\)</span> while the marginal MLE is based on only <span class="math inline">\(R_1\)</span> and <span class="math inline">\(R_3\)</span>. This estimator can be obtained as follows:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_mmle</span> <span class="op">=</span> <span class="fu"><a href="../reference/marginal_mle.html">marginal_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R1</span>, R3 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R3</span>, n <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">pi0</span>,
                        alpha0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha0</span>, alpha <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha</span>, 
                        beta0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta0</span>, beta <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span>
<span class="va">fit_mmle</span></code></pre></div>
<pre><code><span class="co">## Method: Marginal MLE</span>
<span class="co">## </span>
<span class="co">## Estimated proportion: 3.6160%</span>
<span class="co">## Standard error      : 0.4927%</span>
<span class="co">## </span>
<span class="co">## Confidence interval at the 95% level:</span>
<span class="co">## Asymptotic Approach: 2.6504% - 4.5816%</span>
<span class="co">## </span>
<span class="co">## Assumed measurement error: alpha  = 1%, beta = 2%,</span>
<span class="co">##                            alpha0 = 1% </span>
<span class="co">## </span>
<span class="co">## Estimated false negative rate of the</span>
<span class="co">## official procedure: beta0 = 71.35%</span>
<span class="co">## CI at the 95% level: 63.96% - 78.73%</span>
<span class="co">## Sampling: Random</span></code></pre>
<p>Moreover, the moment estimator, which is simply based on <span class="math inline">\(R_3\)</span>, can be computed as follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_mme</span> <span class="op">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span><span class="op">(</span>R3 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R3</span>, n <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">pi0</span>,
                           alpha0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha0</span>, alpha <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha</span>, 
                           beta0 <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta0</span>, beta <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span>
<span class="va">fit_mme</span></code></pre></div>
<pre><code><span class="co">## Method: Moment Estimator</span>
<span class="co">## </span>
<span class="co">## Estimated proportion: 3.5996%</span>
<span class="co">## Standard error      : 0.4919%</span>
<span class="co">## </span>
<span class="co">## Confidence intervals at the 95% level:</span>
<span class="co">## Asymptotic Approach: 2.6355% - 4.5636%</span>
<span class="co">## Clopper-Pearson    : 2.6968% - 4.6979%</span>
<span class="co">## </span>
<span class="co">## Assumed measurement error: alpha  = 1%, beta = 2%,</span>
<span class="co">##                            alpha0 = 1% </span>
<span class="co">## </span>
<span class="co">## Estimated false negative rate of the</span>
<span class="co">## official procedure: beta0 = 71.22%</span>
<span class="co">## CI at the 95% level: 63.78% - 78.66%</span>
<span class="co">## Sampling: Random</span></code></pre>
<p>It can be observed that the function <code><a href="../reference/moment_estimator.html">moment_estimator()</a></code> provides both asymtoptic and CP confidence intervals. Finally for comparison purposes, <code>cape</code> package also contains the MLE based on the sample survey, i.e. the sample average estimator, which can be obtained as follows:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">fit_smle</span> <span class="op">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">R</span>, n <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">R</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span>
<span class="va">fit_smle</span></code></pre></div>
<pre><code><span class="co">## Method: Survey MLE</span>
<span class="co">## </span>
<span class="co">## Estimated proportion: 3.8488%</span>
<span class="co">## Standard error      : 0.5652%</span>
<span class="co">## </span>
<span class="co">## Confidence intervals at the 95% level:</span>
<span class="co">## Asymptotic Approach: 2.7409% - 4.9567%</span>
<span class="co">## Clopper-Pearson    : 2.7990% - 5.0858%</span>
<span class="co">## </span>
<span class="co">## Assumed measurement error: alpha = 1%, beta = 2% </span>
<span class="co">## Sampling: Random</span></code></pre>
</div>
<div class="section level1 unnumbered">
<h1 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-brown2001" class="csl-entry">
Brown, L. D., T. Cai, and A. DasGupta. 2001. <span>“Interval Estimation for a Binomial Proportion.”</span> <em>Statistical Science</em> 16: 101–33.
</div>
<div id="ref-ClPe34" class="csl-entry">
Clopper, C. J., and E. S. Pearson. 1934. <span>“The Use of Confidence or Fiducial Limits Illustrated in the Case of the Binomial.”</span> <em>Biometrika</em> 26: 404–13.
</div>
<div id="ref-fisher35" class="csl-entry">
Fisher, R. A. 1935. <span>“The Fiducial Argument in Statistical Inference.”</span> <em>Annals of Eugenics</em> 6: 391–98.
</div>
<div id="ref-guerrier2020prevalence" class="csl-entry">
Guerrier, Stéphane, Christoph Kuzmics, and Maria-Pia Victoria-Feser. 2022. <span>“Prevalence Estimation from Random Samples and Census Data with Participation Bias.”</span> <a href="http://arxiv.org/abs/2012.10745" class="external-link">http://arxiv.org/abs/2012.10745</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Stéphane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.1.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>

<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Results Reproducibility â€¢ pempi</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Results Reproducibility">
<meta property="og:description" content="pempi">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pempi</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/get_started.html">Get started</a>
</li>
<li>
  <a href="../articles/reproducibility.html">Reproducibility</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/stephaneguerrier/pempi" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Results Reproducibility</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/stephaneguerrier/pempi/blob/HEAD/vignettes/reproducibility.Rmd" class="external-link"><code>vignettes/reproducibility.Rmd</code></a></small>
      <div class="hidden name"><code>reproducibility.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="case-study-application-to-austrian-covid-19-survey">Case study: Application to Austrian COVID-19 survey<a class="anchor" aria-label="anchor" href="#case-study-application-to-austrian-covid-19-survey"></a>
</h2>
<p>We use the methodology developed in this paper for the case of the
COVID-19 prevalence estimation using the results of a survey done in
November 2020 by <span class="citation">Statistics Austria
(2020)</span>. We also compare the different approaches, in order to
illustrate, in practice, the impact of choosing one method rather than
another one. In November 2020, a survey sample of <span class="math inline">\(n=2287\)</span> was collected to test for COVID-19
using PCR-tests. Seventy-two participants were tested positive, and
among these ones, thirty-five (<span class="math inline">\(R_1=35\)</span>) had declared to have been tested
positive with the official procedure, during the same month. In
November, there were <span class="math inline">\(93914\)</span> declared
cases among the official (approximately) <span class="math inline">\(7166167\)</span> inhabitants in Austria (above 16
years old), so that <span class="math inline">\(\pi_0 \approx
1.3105\%\)</span>. The sensitivity (<span class="math inline">\(1-\alpha\)</span>) and the specificity (<span class="math inline">\(1-\beta\)</span>) are not known with precision, so
that we present estimates of the prevalence without misclassification
error as well as for values for the FP and FN rates, that are plausible
given the data and according to the sensitivity and specificity reported
in or .</p>
<p>The results presented in Table 1 of <span class="citation">Guerrier,
Kuzmics, and Victoria-Feser (2022)</span> can be reproduced as
follows:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load pempi</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/stephaneguerrier/pempi" class="external-link">pempi</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Austrian data (November 2020)</span></span>
<span><span class="va">pi0</span> <span class="op">=</span> <span class="fl">93914</span><span class="op">/</span><span class="fl">7166167</span></span>
<span></span>
<span><span class="co"># Load data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"covid19_austria"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Random sampling</span></span>
<span><span class="va">n</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">)</span></span>
<span><span class="va">R1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">R2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">R3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">R4</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Weighted sampling</span></span>
<span><span class="va">R1w</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">R2w</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">R3w</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">1</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">R4w</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">[</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">Y</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">covid19_austria</span><span class="op">$</span><span class="va">Z</span> <span class="op">==</span> <span class="fl">0</span><span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Print table</span></span>
<span><span class="va">data_mat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">R1w</span>, <span class="va">R2w</span>, <span class="va">R3w</span>, <span class="va">R4w</span>, <span class="va">R1</span>, <span class="va">R2</span>, <span class="va">R3</span>, <span class="va">R4</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">4</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">data_mat</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Weighted sampling"</span>, <span class="st">"Unweighted sampling"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">data_mat</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"R1 (R11)"</span>, <span class="st">"R2 (R10)"</span>, <span class="st">"R3 (R01)"</span>, <span class="st">"R4 (R00)"</span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">data_mat</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table class="table">
<thead><tr class="header">
<th align="left"></th>
<th align="right">R1 (R11)</th>
<th align="right">R2 (R10)</th>
<th align="right">R3 (R01)</th>
<th align="right">R4 (R00)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Weighted sampling</td>
<td align="right">33.3589</td>
<td align="right">0</td>
<td align="right">38.2712</td>
<td align="right">2218.37</td>
</tr>
<tr class="even">
<td align="left">Unweighted sampling</td>
<td align="right">35.0000</td>
<td align="right">0</td>
<td align="right">37.0000</td>
<td align="right">2218.00</td>
</tr>
</tbody>
</table>
<p>The data can be summarized as follows:</p>
<ul>
<li>
<span class="math inline">\(n\)</span> = 2290</li>
<li>
<span class="math inline">\(\pi_0\)</span> = 1.3105%</li>
<li>
<span class="math inline">\(R_{11}\)</span> = 35 (which is denoted
as <code>R1</code> in the package).</li>
<li>
<span class="math inline">\(\bar{R}_{11}\)</span> = 33.3589 (which
is denoted as <code>R1</code> or <code>R1w</code> in the package).</li>
<li>
<span class="math inline">\(R_{10}\)</span> = 0 (which is denoted as
<code>R2</code> in the package).</li>
<li>
<span class="math inline">\(\bar{R}_{10}\)</span> = 0 (which is
denoted as <code>R2</code> or <code>R2w</code> in the package).</li>
<li>
<span class="math inline">\(R_{01}\)</span> = 37 (which is denoted
as <code>R3</code> in the package).</li>
<li>
<span class="math inline">\(\bar{R}_{01}\)</span> = 38.2712 (which
is denoted as <code>R3</code> or <code>R3w</code> in the package).</li>
<li>
<span class="math inline">\(R_{00}\)</span> = 2218 (which is denoted
as <code>R4</code> in the package).</li>
<li>
<span class="math inline">\(\bar{R}_{00}\)</span> = 2218.3698 (which
is denoted as <code>R4</code> or <code>R4w</code> in the package).</li>
</ul>
<p>We can check that <span class="math inline">\(R_{11} + R_{10} +
R_{01} + R_{00} = n\)</span></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R1</span> <span class="op">+</span> <span class="va">R2</span> <span class="op">+</span> <span class="va">R3</span> <span class="op">+</span> <span class="va">R4</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2290</span></span></code></pre>
<p>and <span class="math inline">\(\bar{R}_{11} + \bar{R}_{10} +
\bar{R}_{01} + \bar{R}_{00} = n\)</span></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">R1w</span> <span class="op">+</span> <span class="va">R2w</span> <span class="op">+</span> <span class="va">R3w</span> <span class="op">+</span> <span class="va">R4w</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2290</span></span></code></pre>
<p>For the analysis we consider the possibility of measurement error, in
which we use the following values:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Measurement error</span></span>
<span><span class="va">alpha0</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">beta</span> <span class="op">=</span> <span class="fl">10</span><span class="op">/</span><span class="fl">100</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="survey-mle">Survey MLE<a class="anchor" aria-label="anchor" href="#survey-mle"></a>
</h2>
<div class="section level3">
<h3 id="survey-mle-with-random-sampling">Survey MLE with random sampling<a class="anchor" aria-label="anchor" href="#survey-mle-with-random-sampling"></a>
</h3>
<p>The Survey MLE (with and without measurement error) can be compute as
follows:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survey MLE without measurement error</span></span>
<span><span class="op">(</span><span class="va">smle_no_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R1</span> <span class="op">+</span> <span class="va">R3</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Survey MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 3.1441%</span></span>
<span><span class="co">## Standard error      : 0.3647%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence intervals at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.4294% - 3.8588%</span></span>
<span><span class="co">## Clopper-Pearson    : 2.4680% - 3.9433%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha = 0%, beta = 0% </span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survey MLE with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">smle_with_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R1</span> <span class="op">+</span> <span class="va">R3</span>, n <span class="op">=</span> <span class="va">n</span>, </span>
<span>                              alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Survey MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.4091%</span></span>
<span><span class="co">## Standard error      : 0.4097%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence intervals at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.6060% - 3.2122%</span></span>
<span><span class="co">## Clopper-Pearson    : 1.6495% - 3.3070%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha = 1%, beta = 10% </span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="survey-mle-with-stratified-sampling">Survey MLE with stratified sampling<a class="anchor" aria-label="anchor" href="#survey-mle-with-stratified-sampling"></a>
</h3>
<p>In the case of a stratified sampling, the Survey MLE (with and
without measurement error) can be compute as follows:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survey (weighted) MLE without measurement error</span></span>
<span><span class="op">(</span><span class="va">smle_no_meas_error_strat</span> <span class="op">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R1w</span> <span class="op">+</span> <span class="va">R3w</span>, n <span class="op">=</span> <span class="va">n</span>, </span>
<span>                            V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Survey MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 3.1280%</span></span>
<span><span class="co">## Standard error      : 0.4471%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.2517% - 4.0042%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha = 0%, beta = 0% </span></span>
<span><span class="co">## Sampling: Stratified with V = 1.51</span></span></code></pre>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survey MLE with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">smle_with_meas_error_strat</span> <span class="op">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R1w</span> <span class="op">+</span> <span class="va">R3w</span>, n <span class="op">=</span> <span class="va">n</span>,</span>
<span>                             alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, </span>
<span>                             V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Survey MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.3910%</span></span>
<span><span class="co">## Standard error      : 0.5023%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.4064% - 3.3755%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha = 1%, beta = 10% </span></span>
<span><span class="co">## Sampling: Stratified with V = 1.51</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="moment-based-estimator">Moment-based estimator<a class="anchor" aria-label="anchor" href="#moment-based-estimator"></a>
</h2>
<div class="section level3">
<h3 id="moment-based-estimator-with-random-sampling">Moment-based estimator with random sampling<a class="anchor" aria-label="anchor" href="#moment-based-estimator-with-random-sampling"></a>
</h3>
<p>In the case of a random sampling, the moment-based estimator or MME
(with and without measurement error) can be compute as follows:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MME without measurement error</span></span>
<span><span class="op">(</span><span class="va">mme_no_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span><span class="op">(</span>R3 <span class="op">=</span> <span class="va">R3</span>, n <span class="op">=</span> <span class="va">n</span>, </span>
<span>                            pi0 <span class="op">=</span> <span class="va">pi0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Moment Estimator</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.9262%</span></span>
<span><span class="co">## Standard error      : 0.2635%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence intervals at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.4099% - 3.4426%</span></span>
<span><span class="co">## Clopper-Pearson    : 2.4506% - 3.5308%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 0%, beta = 0%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 55.21%</span></span>
<span><span class="co">## CI at the 95% level: 47.31% - 63.12%</span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MME with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">mme_with_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span><span class="op">(</span>R3 <span class="op">=</span> <span class="va">R3</span>, n <span class="op">=</span> <span class="va">n</span>,</span>
<span>                              pi0 <span class="op">=</span> <span class="va">pi0</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, </span>
<span>                              beta <span class="op">=</span> <span class="va">beta</span>, alpha0 <span class="op">=</span> <span class="va">alpha0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Moment Estimator</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.0171%</span></span>
<span><span class="co">## Standard error      : 0.2960%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence intervals at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.4369% - 2.5973%</span></span>
<span><span class="co">## Clopper-Pearson    : 1.4827% - 2.6963%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 1%, beta = 10%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 35.03%</span></span>
<span><span class="co">## CI at the 95% level: 16.34% - 53.72%</span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="moment-based-estimator-with-stratified-sampling">Moment-based estimator with stratified sampling<a class="anchor" aria-label="anchor" href="#moment-based-estimator-with-stratified-sampling"></a>
</h3>
<p>In the case of a stratified sampling, the MME (with and without
measurement error) can be compute as follows:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MME without measurement error</span></span>
<span><span class="op">(</span><span class="va">mme_no_meas_error_strat</span> <span class="op">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span><span class="op">(</span>R3 <span class="op">=</span> <span class="va">R3w</span>, n <span class="op">=</span> <span class="va">n</span>,</span>
<span>                          pi0 <span class="op">=</span> <span class="va">pi0</span>,</span>
<span>                          V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Moment Estimator</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.9818%</span></span>
<span><span class="co">## Standard error      : 0.3292%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.3365% - 3.6270%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 0%, beta = 0%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 56.05%</span></span>
<span><span class="co">## CI at the 95% level: 46.54% - 65.56%</span></span>
<span><span class="co">## Sampling: Stratified with V = 1.51</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MME with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">mme_with_meas_error_strat</span> <span class="op">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span><span class="op">(</span>R3 <span class="op">=</span> <span class="va">R3w</span>, n <span class="op">=</span> <span class="va">n</span>,</span>
<span>                             pi0 <span class="op">=</span> <span class="va">pi0</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>                             alpha0 <span class="op">=</span> <span class="va">alpha0</span>, </span>
<span>                             V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Moment Estimator</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.0794%</span></span>
<span><span class="co">## Standard error      : 0.3699%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.3544% - 2.8045%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 1%, beta = 10%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 36.98%</span></span>
<span><span class="co">## CI at the 95% level: 15.00% - 58.95%</span></span>
<span><span class="co">## Sampling: Stratified with V = 1.51</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="conditional-mle">Conditional MLE<a class="anchor" aria-label="anchor" href="#conditional-mle"></a>
</h2>
<div class="section level3">
<h3 id="conditional-mle-with-random-sampling">Conditional MLE with random sampling<a class="anchor" aria-label="anchor" href="#conditional-mle-with-random-sampling"></a>
</h3>
<p>In the case of a random sampling, the conditional MLE or CMLE (with
and without measurement error) can be compute as follows:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CMLE without measurement error</span></span>
<span><span class="op">(</span><span class="va">cmle_no_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R1</span>, R2 <span class="op">=</span> <span class="va">R2</span>, </span>
<span>                            R3 <span class="op">=</span> <span class="va">R3</span>, R4 <span class="op">=</span> <span class="va">R4</span>, pi0 <span class="op">=</span> <span class="va">pi0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Conditional MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.9317%</span></span>
<span><span class="co">## Standard error      : 0.2639%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.4145% - 3.4489%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 0%, beta = 0%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 55.30%</span></span>
<span><span class="co">## CI at the 95% level: 47.41% - 63.18%</span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CMLE with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">cmle_with_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R1</span>, R2 <span class="op">=</span> <span class="va">R2</span>, </span>
<span>                              R3 <span class="op">=</span> <span class="va">R3</span>, R4 <span class="op">=</span> <span class="va">R4</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>, </span>
<span>                              alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, </span>
<span>                              alpha0 <span class="op">=</span> <span class="va">alpha0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Conditional MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.0200%</span></span>
<span><span class="co">## Standard error      : 0.2962%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.4394% - 2.6006%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 1%, beta = 10%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 35.12%</span></span>
<span><span class="co">## CI at the 95% level: 16.48% - 53.77%</span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="conditional-mle-with-stratified-sampling">Conditional MLE with stratified sampling<a class="anchor" aria-label="anchor" href="#conditional-mle-with-stratified-sampling"></a>
</h3>
<p>In the case of a stratified sampling, the CMLE (with and without
measurement error) can be compute as follows:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CMLE without measurement error</span></span>
<span><span class="op">(</span><span class="va">cmle_no_meas_error_strat</span> <span class="op">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R1w</span>, R2 <span class="op">=</span> <span class="va">R2w</span>, </span>
<span>                            R3 <span class="op">=</span> <span class="va">R3w</span>, R4 <span class="op">=</span> <span class="va">R4w</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>, </span>
<span>                            V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Conditional MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.9841%</span></span>
<span><span class="co">## Standard error      : 0.3294%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.3385% - 3.6297%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 0%, beta = 0%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 56.08%</span></span>
<span><span class="co">## CI at the 95% level: 46.58% - 65.59%</span></span>
<span><span class="co">## Sampling: Stratified with V = 1.51</span></span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># CMLE with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">cmle_with_meas_error_strat</span> <span class="op">=</span> <span class="fu"><a href="../reference/conditional_mle.html">conditional_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R1w</span>, R2 <span class="op">=</span> <span class="va">R2w</span>, </span>
<span>                              R3 <span class="op">=</span> <span class="va">R3w</span>, R4 <span class="op">=</span> <span class="va">R4w</span>, n <span class="op">=</span> <span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>,</span>
<span>                              alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, </span>
<span>                              alpha0 <span class="op">=</span> <span class="va">alpha0</span>, </span>
<span>                              V <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Conditional MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.0831%</span></span>
<span><span class="co">## Standard error      : 0.3702%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.3574% - 2.8087%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 1%, beta = 10%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 37.09%</span></span>
<span><span class="co">## CI at the 95% level: 15.17% - 59.00%</span></span>
<span><span class="co">## Sampling: Stratified with V = 1.51</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="marginal-mle">Marginal MLE<a class="anchor" aria-label="anchor" href="#marginal-mle"></a>
</h2>
<div class="section level3">
<h3 id="marginal-mle-with-random-sampling">Marginal MLE with random sampling<a class="anchor" aria-label="anchor" href="#marginal-mle-with-random-sampling"></a>
</h3>
<p>In the case of a random sampling, the marginal MLE or MMLE (with and
without measurement error) can be compute as follows:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MMLE without measurement error</span></span>
<span><span class="op">(</span><span class="va">mmle_no_meas_error_random</span> <span class="op">=</span> <span class="fu"><a href="../reference/marginal_mle.html">marginal_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R1</span>, R3 <span class="op">=</span> <span class="va">R3</span>, n <span class="op">=</span> <span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">pi0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Marginal MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.9317%</span></span>
<span><span class="co">## Standard error      : 0.2639%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 2.4145% - 3.4489%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 0%, beta = 0%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 55.30%</span></span>
<span><span class="co">## CI at the 95% level: 47.41% - 63.18%</span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># MMLE with measurement error (as defined above)</span></span>
<span><span class="op">(</span><span class="va">mmle_with_meas_error_random</span>  <span class="op">=</span> <span class="fu"><a href="../reference/marginal_mle.html">marginal_mle</a></span><span class="op">(</span>R1 <span class="op">=</span> <span class="va">R1</span>, R3 <span class="op">=</span> <span class="va">R3</span>, n <span class="op">=</span> <span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, alpha0 <span class="op">=</span> <span class="va">alpha0</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Method: Marginal MLE</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated proportion: 2.0200%</span></span>
<span><span class="co">## Standard error      : 0.2962%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Confidence interval at the 95% level:</span></span>
<span><span class="co">## Asymptotic Approach: 1.4394% - 2.6006%</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Assumed measurement error: alpha  = 1%, beta = 10%,</span></span>
<span><span class="co">##                            alpha0 = 0% </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Estimated false negative rate of the</span></span>
<span><span class="co">## official procedure: beta0 = 35.12%</span></span>
<span><span class="co">## CI at the 95% level: 16.48% - 53.77%</span></span>
<span><span class="co">## Sampling: Random</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="marginal-mle-with-stratified-sampling">Marginal MLE with stratified sampling<a class="anchor" aria-label="anchor" href="#marginal-mle-with-stratified-sampling"></a>
</h3>
<p>The MMLE is currently not implemented in the case of a stratified
sampling.</p>
</div>
</div>
<div class="section level2">
<h2 id="replicating-table-2">Replicating Table 2<a class="anchor" aria-label="anchor" href="#replicating-table-2"></a>
</h2>
<p>Table 2 can be replicated as follows:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">table2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">6</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">table2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SMLE (stratified)"</span>, <span class="st">"MME (stratified)"</span>, <span class="st">"Estimated beta0 (stratified)"</span>, <span class="st">"SMLE (random)"</span>, <span class="st">"MME (random)"</span>, <span class="st">"Estimated beta0 (random)"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">table2</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Estimates (no meas. err.)"</span>, <span class="st">"95% CI (low)"</span>, <span class="st">"95% CI (high)"</span>, <span class="st">"Estimates (with meas. err.)"</span>, <span class="st">"95% CI (low)"</span>, <span class="st">"95% CI (high)"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table2</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">smle_no_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">smle_no_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span>,</span>
<span>                <span class="va">smle_with_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">smle_with_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">table2</span><span class="op">[</span><span class="fl">2</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mme_no_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">mme_no_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span>,</span>
<span>                <span class="va">mme_with_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">mme_with_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">table2</span><span class="op">[</span><span class="fl">3</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mme_no_meas_error_strat</span><span class="op">$</span><span class="va">beta0</span>,</span>
<span>                <span class="va">mme_no_meas_error_strat</span><span class="op">$</span><span class="va">ci_beta0</span>,</span>
<span>                <span class="va">mme_with_meas_error_strat</span><span class="op">$</span><span class="va">beta0</span>,</span>
<span>                <span class="va">mme_with_meas_error_strat</span><span class="op">$</span><span class="va">ci_beta0</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table2</span><span class="op">[</span><span class="fl">4</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">smle_no_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">smle_no_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span>,</span>
<span>                <span class="va">smle_with_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">smle_with_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span><span class="op">)</span></span>
<span></span>
<span><span class="va">table2</span><span class="op">[</span><span class="fl">5</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mme_no_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">mme_no_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span>,</span>
<span>                <span class="va">mme_with_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>,</span>
<span>                <span class="va">mme_with_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span><span class="op">)</span> </span>
<span><span class="va">table2</span><span class="op">[</span><span class="fl">6</span>, <span class="op">]</span> <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">mme_no_meas_error_random</span><span class="op">$</span><span class="va">beta0</span>,</span>
<span>                <span class="va">mme_no_meas_error_random</span><span class="op">$</span><span class="va">ci_beta0</span>,</span>
<span>                <span class="va">mme_with_meas_error_random</span><span class="op">$</span><span class="va">beta0</span>,</span>
<span>                <span class="va">mme_with_meas_error_random</span><span class="op">$</span><span class="va">ci_beta0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">table2</span>, <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<table style="width:100%;" class="table">
<colgroup>
<col width="21%">
<col width="18%">
<col width="9%">
<col width="10%">
<col width="20%">
<col width="9%">
<col width="10%">
</colgroup>
<thead><tr class="header">
<th align="left"></th>
<th align="right">Estimates (no meas. err.)</th>
<th align="right">95% CI (low)</th>
<th align="right">95% CI (high)</th>
<th align="right">Estimates (with meas. err.)</th>
<th align="right">95% CI (low)</th>
<th align="right">95% CI (high)</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">SMLE (stratified)</td>
<td align="right">3.128</td>
<td align="right">2.252</td>
<td align="right">4.004</td>
<td align="right">2.391</td>
<td align="right">1.406</td>
<td align="right">3.375</td>
</tr>
<tr class="even">
<td align="left">MME (stratified)</td>
<td align="right">2.982</td>
<td align="right">2.336</td>
<td align="right">3.627</td>
<td align="right">2.079</td>
<td align="right">1.354</td>
<td align="right">2.804</td>
</tr>
<tr class="odd">
<td align="left">Estimated beta0 (stratified)</td>
<td align="right">56.049</td>
<td align="right">46.537</td>
<td align="right">65.560</td>
<td align="right">36.977</td>
<td align="right">15.003</td>
<td align="right">58.951</td>
</tr>
<tr class="even">
<td align="left">SMLE (random)</td>
<td align="right">3.144</td>
<td align="right">2.429</td>
<td align="right">3.859</td>
<td align="right">2.409</td>
<td align="right">1.606</td>
<td align="right">3.212</td>
</tr>
<tr class="odd">
<td align="left">MME (random)</td>
<td align="right">2.926</td>
<td align="right">2.410</td>
<td align="right">3.443</td>
<td align="right">2.017</td>
<td align="right">1.437</td>
<td align="right">2.597</td>
</tr>
<tr class="even">
<td align="left">Estimated beta0 (random)</td>
<td align="right">55.215</td>
<td align="right">47.312</td>
<td align="right">63.118</td>
<td align="right">35.028</td>
<td align="right">16.339</td>
<td align="right">53.718</td>
</tr>
</tbody>
</table>
</div>
<div class="section level2">
<h2 id="replicating-figure-1">Replicating Figure 1<a class="anchor" aria-label="anchor" href="#replicating-figure-1"></a>
</h2>
<p>Figure 1 can be obtained by running the file
<code>pempi/figures/case_study.Rnw</code>. A similar base R version can
be obtained as follows:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pi0</span> <span class="op">=</span> <span class="fl">93914</span><span class="op">/</span><span class="fl">7166167</span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F8766DFF"</span>, <span class="st">"#00BFC4FF"</span><span class="op">)</span></span>
<span><span class="va">delta</span> <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="va">cex_pt</span> <span class="op">=</span> <span class="fl">1.5</span></span>
<span><span class="va">lwd_ci</span> <span class="op">=</span> <span class="fl">2</span></span>
<span><span class="va">pch_mme</span> <span class="op">=</span> <span class="fl">16</span></span>
<span><span class="va">pch_smle</span> <span class="op">=</span> <span class="fl">15</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">4.25</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">col_text</span> <span class="op">=</span> <span class="st">"grey60"</span></span>
<span><span class="va">cex_text</span> <span class="op">=</span> <span class="fl">0.85</span></span>
<span><span class="va">cex_text2</span> <span class="op">=</span> <span class="fl">0.65</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">3.5</span><span class="op">)</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Stratified sampling"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1.75</span>, cex <span class="op">=</span> <span class="va">cex_text</span>, at <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"no measurment error"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.75</span>, cex <span class="op">=</span> <span class="va">cex_text2</span>, at <span class="op">=</span> <span class="fl">1</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Random sampling"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1.75</span>, cex <span class="op">=</span> <span class="va">cex_text</span>, at <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"no measurment error"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.75</span>, cex <span class="op">=</span> <span class="va">cex_text2</span>, at <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Stratified sampling"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1.75</span>, cex <span class="op">=</span> <span class="va">cex_text</span>, at <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"with measurment error"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.75</span>, cex <span class="op">=</span> <span class="va">cex_text2</span>, at <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Random sampling"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">1.75</span>, cex <span class="op">=</span> <span class="va">cex_text</span>, at <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"with measurment error"</span>, side <span class="op">=</span> <span class="fl">3</span>, line <span class="op">=</span> <span class="fl">0.75</span>, cex <span class="op">=</span> <span class="va">cex_text2</span>, at <span class="op">=</span> <span class="fl">4</span>, col <span class="op">=</span> <span class="va">col_text</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Prevalence (%)"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pi0</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.18</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">pi</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MME"</span>, <span class="st">"95% CI"</span>,</span>
<span>                    <span class="st">"Survey MLE"</span>, <span class="st">"95% CI"</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">lwd_ci</span>, <span class="cn">NA</span>, <span class="va">lwd_ci</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">pch_mme</span>, <span class="cn">NA</span>, <span class="va">pch_smle</span>, <span class="cn">NA</span><span class="op">)</span>,</span>
<span>       pt.cex <span class="op">=</span> <span class="fl">1.5</span>, cex <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 1) Stratified sampling, without ME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_no_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_mme</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_no_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_no_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_smle</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_no_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 2) Random sampling, without ME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_no_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_mme</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_no_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_no_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_smle</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_no_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 3) Stratified sampling, with ME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_with_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_mme</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_with_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_with_meas_error_strat</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_smle</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_with_meas_error_strat</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># 4) Random sampling, with ME</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_with_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_mme</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">-</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">mme_with_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_with_meas_error_random</span><span class="op">$</span><span class="va">estimate</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, pch <span class="op">=</span> <span class="va">pch_smle</span>, cex <span class="op">=</span> <span class="va">cex_pt</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span>, <span class="fl">4</span><span class="op">)</span> <span class="op">+</span> <span class="va">delta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">smle_with_meas_error_random</span><span class="op">$</span><span class="va">ci_asym</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="va">lwd_ci</span><span class="op">)</span></span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-13-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="replicating-figure-2">Replicating Figure 2<a class="anchor" aria-label="anchor" href="#replicating-figure-2"></a>
</h2>
<p>Figure 2 can be obtained by running the file
<code>pempi/figures/case_study.Rnw</code>. A similar base R version can
be obtained as follows:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Assumptions</span></span>
<span><span class="va">pi0</span> <span class="op">=</span> <span class="fl">93914</span><span class="op">/</span><span class="fl">7166167</span></span>
<span><span class="va">alpha</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">alpha0</span> <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="va">m</span> <span class="op">=</span> <span class="fl">300</span></span>
<span><span class="va">beta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">0</span>, to <span class="op">=</span> <span class="fl">30</span>, length.out <span class="op">=</span> <span class="va">m</span><span class="op">)</span><span class="op">/</span><span class="fl">100</span></span>
<span><span class="va">res_moment</span> <span class="op">=</span> <span class="va">res_smle</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="va">m</span>, <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">V</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">covid19_austria</span><span class="op">$</span><span class="va">weights</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">m</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Moment estimator</span></span>
<span>  <span class="va">inter</span> <span class="op">=</span> <span class="fu"><a href="../reference/moment_estimator.html">moment_estimator</a></span><span class="op">(</span>R3 <span class="op">=</span> <span class="va">R3w</span>, n <span class="op">=</span> <span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>,</span>
<span>                           alpha <span class="op">=</span> <span class="va">alpha</span>, alpha0 <span class="op">=</span> <span class="va">alpha0</span>,</span>
<span>                           beta <span class="op">=</span> <span class="va">beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, V <span class="op">=</span> <span class="va">V</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">res_moment</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">inter</span><span class="op">$</span><span class="va">estimate</span>, <span class="va">inter</span><span class="op">$</span><span class="va">ci_asym</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Survey MLE</span></span>
<span>  <span class="va">inter</span> <span class="op">=</span> <span class="fu"><a href="../reference/survey_mle.html">survey_mle</a></span><span class="op">(</span>R <span class="op">=</span> <span class="va">R1w</span> <span class="op">+</span> <span class="va">R3w</span>, n <span class="op">=</span> <span class="va">n</span>, pi0 <span class="op">=</span> <span class="va">pi0</span>,</span>
<span>                     alpha <span class="op">=</span> <span class="va">alpha</span>, alpha0 <span class="op">=</span> <span class="va">alpha0</span>,</span>
<span>                     beta <span class="op">=</span> <span class="va">beta</span><span class="op">[</span><span class="va">i</span><span class="op">]</span>, V <span class="op">=</span> <span class="va">V</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">res_smle</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">inter</span><span class="op">$</span><span class="va">estimate</span>, <span class="va">inter</span><span class="op">$</span><span class="va">ci_asym</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="va">cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F8766DFF"</span>, <span class="st">"#00BFC4FF"</span><span class="op">)</span></span>
<span><span class="va">cols2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#F8766D1F"</span>, <span class="st">"#00BFC41F"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="cn">NA</span>, xlim <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4.25</span><span class="op">)</span>, axes <span class="op">=</span> <span class="cn">FALSE</span>, ann <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/grid.html" class="external-link">grid</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/box.html" class="external-link">box</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/axis.html" class="external-link">axis</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">beta</span>, <span class="st">" (%)"</span><span class="op">)</span><span class="op">)</span>, side <span class="op">=</span> <span class="fl">1</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html" class="external-link">mtext</a></span><span class="op">(</span><span class="st">"Prevalence (%)"</span>, side <span class="op">=</span> <span class="fl">2</span>, line <span class="op">=</span> <span class="fl">3</span>, cex <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pi0</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">100</span><span class="op">*</span><span class="va">pi0</span>, lwd <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html" class="external-link">text</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">1.18</span>, <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">pi</span><span class="op">[</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>, cex <span class="op">=</span> <span class="fl">1.15</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"MME"</span>, <span class="st">"95% CI"</span>,</span>
<span>                    <span class="st">"Survey MLE"</span>, <span class="st">"95% CI"</span><span class="op">)</span>,</span>
<span>       bty <span class="op">=</span> <span class="st">"n"</span>, col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">cols2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,<span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">cols2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span>
<span>       lwd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="cn">NA</span>, <span class="fl">3</span>, <span class="cn">NA</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">15</span>, <span class="cn">NA</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>       pt.cex <span class="op">=</span> <span class="fl">2.5</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">beta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">res_moment</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_moment</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">res_moment</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="va">cols2</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="va">beta</span>, <span class="fl">100</span><span class="op">*</span><span class="va">res_smle</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, lwd <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="va">cols</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/polygon.html" class="external-link">polygon</a></span><span class="op">(</span><span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">beta</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="fl">100</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">res_smle</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html" class="external-link">rev</a></span><span class="op">(</span><span class="va">res_smle</span><span class="op">[</span>,<span class="fl">3</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        col <span class="op">=</span> <span class="va">cols2</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, border <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span></span></code></pre></div>
<p><img src="reproducibility_files/figure-html/unnamed-chunk-14-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="simulation-study">Simulation Study<a class="anchor" aria-label="anchor" href="#simulation-study"></a>
</h2>
<p>The results summarized in Appendix C and presented in Appendix D of
<span class="citation">Guerrier, Kuzmics, and Victoria-Feser
(2022)</span> can be replicated as follows:</p>
<ol style="list-style-type: decimal">
<li>Run the file <code>pempi/simulations/simulation_script.R</code> which
should take a couple of hours on a standard laptop and generate the file
<code>pempi/simulations/simulations.RData</code>.</li>
<li>Run the file <code>pempi/simulations/figures.Rnw</code> (which reads
<code>pempi/simulations/simulations.RData</code>) to generates Figures 3,
4 and 5 (as well as color versions of these figures).</li>
</ol>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-guerrier2020prevalence" class="csl-entry">
Guerrier, StÃ©phane, Christoph Kuzmics, and Maria-Pia Victoria-Feser.
2022. <span>â€œPrevalence Estimation from Random Samples and Census Data
with Participation Bias.â€</span> <a href="https://arxiv.org/abs/2012.10745" class="external-link">https://arxiv.org/abs/2012.10745</a>.
</div>
<div id="ref-StatAU20" class="csl-entry">
Statistics Austria. 2020. <span>â€œ<span class="nocase">PrÃ¤valenz von
SARS-CoV-2-Infektionen liegt bei 3,1%</span>.â€</span> <a href="https://www.statistik.at/web_de/presse/124846.html" class="external-link">https://www.statistik.at/web_de/presse/124846.html</a>.
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by StÃ©phane Guerrier, Maria-Pia Victoria-Feser, Christoph Kuzmics.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
